# Основы Docker

Контейнер докера работает изолированно от операционной системы. Каждый контейнер независим от другого, и в нём есть всё необходимое для работы конкретно этого контейнера. 

![[Pasted image 20250317003315.png]]

### Docker работает только в линукс? 

Между ОС и Docker в случае windows обязательно ставится прослойка в виде Linux Virtual OC. При установке Docker это происходит само по себе (ничего специально делать не нужно). 
![[Pasted image 20250317003510.png]]


### Но почему же не виртуальная машина? 

Старый подход был в том, что для каждого отдельного сервиса поднималась своя виртуальная машина. Для наглядности приведу данную схему: 
![[Pasted image 20250317004600.png]]

Большая проблема в том, что мы несколько раз устанавливаем ОС на каждую VM. Казалось бы, это имеет место и для Docker, но есть один нюанс. Docker под своим капотом имеет систему слоёв.
Каждый слой может быть:
- read-only, когда слой неизменяемый и может использоваться несколькими контейнерами
- read-write, когда контейнер создаётся из образа, он получает этот слой

Используется COW (Copy-On-Write) механизм, чтобы не дублировать файлы. Когда контейнер запущен, он использует общие read-only слои, и если нужно изменить какой-то файл из read-only, создаётся копия файла в слое read-write, и работа происходит уже там. 

# Основные команды Docker

Чтобы запустить какой-то контейнер, нужно использовать команду: 

```
docker run hello-world
```

Чтобы посмотреть текущие запущенные контейнеры: 

```
docker ps -a
```

Можно удалить контейнер по id: 

```
docker rm {id}
```

Скачать образ: 

```
docker pull ubuntu
```

При запуске можно указывать команды после запуска контейнера: 

```
docker run ubuntu sleep 5
```

Можно добавлять флаг -d, чтобы запускать в фоновом режиме 

```
docker run -d ubuntu
```

Чтобы **запустить** уже созданный контейнер, используй команду: 

```
docker start {id}
```

Подключиться к уже существующему контейнеру можно командой 

```
docker exec -it {id/name} /bin/bash
```

# Порты Docker

При запуске команды

```
docker run -p 80:80 nginx
```

![[Pasted image 20250318235738.png]]

То есть второе число указано в документации к образу, а вот наружний порт мы можем менять, как угодно - по нему мы будем иметь доступ.

